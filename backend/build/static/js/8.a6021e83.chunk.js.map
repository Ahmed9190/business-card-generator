{"version":3,"sources":["pages/cards-page/cards-page.jsx"],"names":["CardsPage","useState","cards","setCards","favCards","setFavCards","searchField","setSearchField","favouriteOnly","setFavouriteOnly","useEffect","axios","get","then","data","localStorage","getItem","headers","favouriteCards","map","c_id","catch","e","Toast","response","handleClickStar","isStarred","delete","filter","deletedCardId","deleteFromFav","post","addToFav","filteredResults","f_name","l_name","toLowerCase","includes","className","solid","search","favourite","i","u_id","color_index","has_whatsapp","cardData","style","position","color","cardColors","hasWhatsapp","onClick"],"mappings":"wRA0GeA,UAhGG,WAAO,IAAD,EACIC,mBAAS,IADb,mBACfC,EADe,KACRC,EADQ,OAEUF,mBAAS,IAFnB,mBAEfG,EAFe,KAELC,EAFK,OAGgBJ,mBAAS,IAHzB,mBAGfK,EAHe,KAGFC,EAHE,OAIoBN,oBAAS,GAJ7B,mBAIfO,EAJe,KAIAC,EAJA,KAiBtBC,qBAAU,WACRC,IACGC,IAAI,cACJC,MAAK,YAAsB,IAAbX,EAAY,EAAlBY,KACPX,EAASD,MAEVW,MAAK,WACAE,aAAaC,QAAQ,QAjB7BL,IACGC,IAAI,wBAAyBK,KAC7BJ,MAAK,YAA+B,IAAtBK,EAAqB,EAA3BJ,KACPT,EAAYa,EAAeC,KAAI,qBAAGC,YAEnCC,OAAM,SAACC,GACNC,YAAMD,EAAEE,SAASV,KAAM,eAaxBO,OAAM,SAACC,GACNC,YAAMD,EAAEE,SAASV,KAAM,cAE1B,IAEH,IAaMW,EAAkB,SAACC,EAAWN,GAC9BM,EATgB,SAACN,GACrBT,IACGgB,OAAO,wBADV,2BACwCV,KADxC,IACiDH,KAAM,CAAEM,WACtDP,MAAK,kBACJR,EAAYD,EAASwB,QAAO,SAACC,GAAD,OAAmBA,IAAkBT,SAElEC,OAAM,SAACC,GAAD,OAAOC,YAAMD,EAAEE,SAASV,KAAM,YAGxBgB,CAAcV,GAdd,SAACA,GAChBT,IACGoB,KAAK,mBAAoB,CAAEX,QAAQH,KACnCJ,MAAK,kBAAMR,EAAY,GAAD,mBAAKD,GAAL,CAAegB,QACrCC,OAAM,SAACC,GAAD,OAAOC,YAAMD,EAAEE,SAASV,KAAM,YAWlCkB,CAASZ,IAGVa,EAAkB/B,EAAM0B,QAC5B,kBAAGM,EAAH,EAAGA,OAAQC,EAAX,EAAWA,OAAQf,EAAnB,EAAmBA,KAAnB,OACE,oBAAGc,EAAH,YAAaC,UAAb,eACIC,cACDC,SAAS/B,EAAY8B,mBACvB5B,GAAgBJ,EAASiC,SAASjB,OAGvC,OACE,sBAAKkB,UAAU,iBAAf,UACE,qBAAKA,UAAU,mBAAf,SACE,cAAC,IAAD,CACEC,OAAK,EACLC,QAAM,EACNC,YAAa1B,aAAaC,QAAQ,OAC5BT,iBAAgBC,gBAAeC,uBAGzC,qBAAK6B,UAAU,qBAAf,SACGL,EAAgBd,KACf,WAAyDuB,GAAM,EAA5DC,KAA6D,IAAvDvB,EAAsD,EAAtDA,KAAMwB,EAAgD,EAAhDA,YAAaC,EAAmC,EAAnCA,aAAiBC,EAAkB,4DACvDpB,EAAYtB,EAASiC,SAASjB,GACpC,OACE,sBAAK2B,MAAO,CAAEC,SAAU,YAAxB,UACE,qBAAKV,UAAU,2BAAf,SACE,cAAC,IAAD,CACEQ,SAAUA,EACVG,MAAOC,IAAWN,GAClBO,YAAaN,MAGjB,qBACEP,UAAU,4BACVS,MAAOrB,EAAY,CAAEuB,MAAO,WAAc,KAC1CG,QAAS,kBAAM3B,EAAgBC,EAAWN,IAH5C,sBARyCsB","file":"static/js/8.a6021e83.chunk.js","sourcesContent":["import axios from \"axios\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport Card from \"../../components/card/card\";\r\nimport Header from \"../../components/header/header\";\r\nimport { cardColors } from \"../handle-card/handle-card-data\";\r\n\r\nimport \"./cards-page.scss\";\r\nimport Toast from \"./../../utils/toastify\";\r\nimport { headers } from \"./../../utils/axios\";\r\n\r\nconst CardsPage = () => {\r\n  const [cards, setCards] = useState([]);\r\n  const [favCards, setFavCards] = useState([]);\r\n  const [searchField, setSearchField] = useState(\"\");\r\n  const [favouriteOnly, setFavouriteOnly] = useState(false);\r\n\r\n  const fetchFavs = () => {\r\n    axios\r\n      .get(\"/read-favourite-cards\", headers)\r\n      .then(({ data: favouriteCards }) => {\r\n        setFavCards(favouriteCards.map(({ c_id }) => c_id));\r\n      })\r\n      .catch((e) => {\r\n        Toast(e.response.data, \"error\");\r\n      });\r\n  };\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get(\"read-cards\")\r\n      .then(({ data: cards }) => {\r\n        setCards(cards);\r\n      })\r\n      .then(() => {\r\n        if (localStorage.getItem(\"jwt\")) fetchFavs();\r\n      })\r\n      .catch((e) => {\r\n        Toast(e.response.data, \"error\");\r\n      });\r\n  }, []);\r\n\r\n  const addToFav = (c_id) =>\r\n    axios\r\n      .post(\"add-to-favourite\", { c_id }, headers)\r\n      .then(() => setFavCards([...favCards, c_id]))\r\n      .catch((e) => Toast(e.response.data, \"error\"));\r\n  const deleteFromFav = (c_id) =>\r\n    axios\r\n      .delete(\"delete-favourite-card\", { ...headers, data: { c_id } })\r\n      .then(() =>\r\n        setFavCards(favCards.filter((deletedCardId) => deletedCardId !== c_id))\r\n      )\r\n      .catch((e) => Toast(e.response.data, \"error\"));\r\n\r\n  const handleClickStar = (isStarred, c_id) => {\r\n    if (isStarred) deleteFromFav(c_id);\r\n    else addToFav(c_id);\r\n  };\r\n\r\n  const filteredResults = cards.filter(\r\n    ({ f_name, l_name, c_id }) =>\r\n      `${f_name} ${l_name}`\r\n        ?.toLowerCase()\r\n        .includes(searchField.toLowerCase()) &&\r\n      (favouriteOnly ? favCards.includes(c_id) : true)\r\n  );\r\n\r\n  return (\r\n    <div className=\"grid-container\">\r\n      <div className=\"card-page-header\">\r\n        <Header\r\n          solid\r\n          search\r\n          favourite={!!localStorage.getItem(\"jwt\")} //check if signed in\r\n          {...{ setSearchField, favouriteOnly, setFavouriteOnly }}\r\n        />\r\n      </div>\r\n      <div className=\"card-page-contents\">\r\n        {filteredResults.map(\r\n          ({ u_id, c_id, color_index, has_whatsapp, ...cardData }, i) => {\r\n            const isStarred = favCards.includes(c_id);\r\n            return (\r\n              <div style={{ position: \"relative\" }} key={i}>\r\n                <div className=\"card-page-card-container\">\r\n                  <Card\r\n                    cardData={cardData}\r\n                    color={cardColors[color_index]}\r\n                    hasWhatsapp={has_whatsapp}\r\n                  />\r\n                </div>\r\n                <div\r\n                  className=\"favourite-button noselect\"\r\n                  style={isStarred ? { color: \"#F8961E\" } : null}\r\n                  onClick={() => handleClickStar(isStarred, c_id)}\r\n                >\r\n                  &#9733;\r\n                </div>\r\n              </div>\r\n            );\r\n          }\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CardsPage;\r\n"],"sourceRoot":""}